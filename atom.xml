<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://jiangjinxinn.github.io</id>
    <title>ç©ºè°ƒæˆ¿</title>
    <updated>2019-10-09T16:32:20.095Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://jiangjinxinn.github.io"/>
    <link rel="self" href="https://jiangjinxinn.github.io/atom.xml"/>
    <logo>https://jiangjinxinn.github.io/images/avatar.png</logo>
    <icon>https://jiangjinxinn.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, ç©ºè°ƒæˆ¿</rights>
    <entry>
        <title type="html"><![CDATA[é›¨ä¸­æ³ªæ°´ç‹¬ç™½ï¼ˆTears in rain monologueï¼‰]]></title>
        <id>https://jiangjinxinn.github.io/post/yu-zhong-lei-shui-du-bai-tears-in-rain-monologue</id>
        <link href="https://jiangjinxinn.github.io/post/yu-zhong-lei-shui-du-bai-tears-in-rain-monologue">
        </link>
        <updated>2019-10-09T16:18:17.000Z</updated>
        <content type="html"><![CDATA[<p>â€œ	è‹±è¯­ï¼šI've seen things you people wouldn't believe. Attack ships on fire off the shoulder of Orion. I watched C-beams glitter in the dark near the TannhÃ¤user Gate. All those moments will be lost in time, like tears in rain. Time to die.	â€</p>
<p>ï¼ˆæˆ‘æ›¾è§è¿‡ä»¤ä½ ä»¬äººç±»éš¾ä»¥ç½®ä¿¡çš„äº‹æƒ…ã€‚æˆ‘çœ‹åˆ°è¿‡æˆ˜èˆ°åœ¨çŒæˆ·åº§è‚©æ—ç†Šç†Šç‡ƒçƒ§ï¼Œä¹Ÿæ›¾çœ‹åˆ°ï¼£å°„çº¿åœ¨å”æ€€ç‘Ÿä¹‹é—¨æ—çš„é»‘æš—é‡Œé—ªè€€ã€‚æ‰€æœ‰çš„é‚£äº›æ—¶åˆ»ï¼Œéƒ½å°†æ¶ˆé€åœ¨æ—¶å…‰ä¸­ï¼Œä¸€å¦‚æ³ªæ°´ï¼Œæ¶ˆå¤±åœ¨é›¨ä¸­ã€‚æ­»äº¡çš„æ—¶åˆ»åˆ°äº†ã€‚ï¼‰</p>
<p><a href="https://zh.wikipedia.org/wiki/%E9%9B%A8%E4%B8%AD%E6%B3%AA%E6%B0%B4%E7%8B%AC%E7%99%BD#cite_note-4">wikipedia</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Shading-JDBC]]></title>
        <id>https://jiangjinxinn.github.io/post/shading-jdbc</id>
        <link href="https://jiangjinxinn.github.io/post/shading-jdbc">
        </link>
        <updated>2019-10-06T13:42:56.000Z</updated>
        <content type="html"><![CDATA[<h2 id="æµç¨‹">æµç¨‹</h2>
<p>åšåœ¨ jdbc å±‚é¢ä¸Š</p>
<h2 id="åˆ†åº“åˆ†è¡¨ç­–ç•¥">åˆ†åº“åˆ†è¡¨ç­–ç•¥</h2>
<ul>
<li>å‚ç›´</li>
<li>æ°´å¹³</li>
<li>
<ul>
<li>ç»‘å®šè¡¨</li>
</ul>
</li>
</ul>
<h2 id="åˆ†ç‰‡">åˆ†ç‰‡</h2>
<h3 id="æ–°å¢">æ–°å¢</h3>
<h2 id="è¡Œè¡¨è¾¾å¼">è¡Œè¡¨è¾¾å¼</h2>
<p>å®ç°åŠ¨æœºï¼šé…ç½®çš„ç®€åŒ–ä¸ä¸€ä½“åŒ–<br>
è¯­æ³•ï¼šä½¿ç”¨ Groovy</p>
<p>sql between æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸<code>org.springframework.dao.InvalidDataAccessApiUsageException: Inline strategy cannot support range sharding.; nested exception is java.lang.IllegalStateException: Inline strategy cannot support range sharding.</code></p>
<h2 id="åˆ†å¸ƒå¼-id-ç”Ÿæˆ">åˆ†å¸ƒå¼ id ç”Ÿæˆ</h2>
<h3 id="é›ªèŠ±ç®—æ³•é»˜è®¤">é›ªèŠ±ç®—æ³•ï¼ˆé»˜è®¤ï¼‰</h3>
<p><img src="https://jiangjinxinn.github.io/post-images/1570369804031.png" alt=""><br>
Sharding-JDBC ä¸­ç”Ÿæˆåæ’å…¥æ•°æ®åº“ä¸­ã€‚</p>
<ol>
<li>æ—¶é’Ÿå›æ‹¨<br>
æœåŠ¡å™¨æ—¶é’Ÿå›æ‹¨ä¼šå¯¼è‡´äº§ç”Ÿé‡å¤åºåˆ—ï¼Œå› æ­¤é»˜è®¤åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆå™¨æä¾›äº†ä¸€ä¸ªæœ€å¤§å®¹å¿çš„æ—¶é’Ÿå›æ‹¨æ¯«ç§’ æ•°ã€‚ å¦‚æœæ—¶é’Ÿå›æ‹¨çš„æ—¶é—´è¶…è¿‡æœ€å¤§å®¹å¿çš„æ¯«ç§’æ•°é˜ˆå€¼ï¼Œåˆ™ç¨‹åºæŠ¥é”™ï¼›å¦‚æœåœ¨å¯å®¹å¿çš„èŒƒå›´å†…ï¼Œé»˜è®¤åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆå™¨ä¼šç­‰å¾…æ—¶é’ŸåŒæ­¥åˆ°æœ€åä¸€æ¬¡ä¸»é”®ç”Ÿæˆçš„æ—¶é—´åå†ç»§ç»­å·¥ä½œã€‚ æœ€å¤§å®¹å¿çš„æ—¶é’Ÿå›æ‹¨æ¯«ç§’æ•°çš„é»˜è®¤å€¼ä¸º0ï¼Œå¯é€šè¿‡å±æ€§è®¾ç½®ã€‚<br>
https://www.jianshu.com/p/98c202f64652</li>
<li>worker id<br>
é‡å¤ worker id ä¼šäº§ç”Ÿç›¸åŒçš„ id https://cloud.tencent.com/developer/article/1074907<br>
worker id å¦‚ä½•é…ç½®ï¼Ÿ</li>
<li>æ²¡æœ‰å¹¶å‘é‡çš„æƒ…å†µä¸‹çš„è¯ï¼Œåºåˆ—å·ä½å‡ ä¹éƒ½æ˜¯ 1ï¼Œæ ¹æ®è·¯ç”±è§„åˆ™éƒ½ä¼šè·¯ç”±åˆ°ä¸€ä¸ªè¡¨ä¸­</li>
</ol>
<h2 id="åˆ†å¸ƒå¼äº‹åŠ¡">åˆ†å¸ƒå¼äº‹åŠ¡</h2>
<p>æœ¬åœ°äº‹åŠ¡ï¼šACID<br>
åˆ†å¸ƒå¼äº‹åŠ¡ï¼šBASEï¼Œé€šè¿‡ä¸šåŠ¡é€»è¾‘å°†äº’æ–¥æ“ä½œä»èµ„æºå±‚é¢ä¸Šç§»è‡³ä¸šåŠ¡å±‚é¢ã€‚é€šè¿‡æ”¾å®½å¯¹å¼ºä¸€è‡´æ€§è¦æ±‚ï¼Œæ¥æ¢å–ç³»ç»Ÿååé‡çš„æå‡</p>
<h3 id="xa">XA</h3>
<p><img src="https://jiangjinxinn.github.io/post-images/1570501311460.png" alt=""><br>
ä¸¤é˜¶æ®µäº‹åŠ¡æäº¤é‡‡ç”¨X/OPENç»„ç»‡å®šä¹‰çš„DTP æ¨¡å‹ï¼Œé€šè¿‡æŠ½è±¡å‡ºæ¥çš„APã€TMã€RM çš„æ¦‚å¿µå¯ä»¥ä¿è¯äº‹åŠ¡çš„å¼ºä¸€è‡´æ€§ã€‚å…¶ä¸­ TM å’Œ RM ä¹‹é—´é‡‡ç”¨ XA åè®®è¿›è¡ŒåŒå‘é€šä¿¡ã€‚ä¸ä¼ ç»Ÿçš„æœ¬åœ°äº‹åŠ¡ç›¸æ¯”ï¼ŒXA äº‹åŠ¡å¢åŠ äº† prepare é˜¶æ®µï¼Œæ•°æ®åº“é™¤äº†è¢«åŠ¨æ¥å—æäº¤æŒ‡ä»¤ä»¥å¤–ï¼Œè¿˜å¯ä»¥åå‘é€šçŸ¥è°ƒç”¨æ–¹äº‹åŠ¡æ˜¯å¦å¯ä»¥è¢«æäº¤ã€‚å› æ­¤ TMå¯ä»¥æ”¶é›†å„åˆ†æ”¯äº‹åŠ¡çš„prepare ç»“æœï¼Œæœ€åè¿›è¡ŒåŸå­æäº¤ï¼Œä¿è¯äº‹åŠ¡çš„å¼ºä¸€è‡´æ€§ã€‚<br>
åˆ†ä¸ºå‡†å¤‡é˜¶æ®µå’Œæäº¤é˜¶æ®µã€‚æ¯ä¸ªå‚ä¸è€…è¦ä¹ˆå‘é€å¤±è´¥ï¼Œè¦ä¹ˆåœ¨æœ¬åœ°æ‰§è¡Œäº‹åŠ¡ï¼Œå†™æœ¬åœ°çš„ redoã€undo æ—¥å¿—ï¼Œä½†ä¸æäº¤ã€‚åè°ƒè€…æ”¶åˆ°äº†å‚ä¸è€…å¤±è´¥æ¶ˆæ¯æˆ–è€…è¶…æ—¶æ¶ˆæ¯ï¼Œç›´æ¥ç»™æ¯ä¸ªå‚ä¸è€…å‘é€å›æ»šï¼ˆrollbackï¼‰æ¶ˆæ¯ï¼Œå¦åˆ™å‘é€æäº¤ï¼ˆcommitï¼‰æ¶ˆæ¯ã€‚<br>
éœ€è¦åœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´è¿›è¡Œåè°ƒï¼Œè€Œå„èŠ‚ç‚¹å¯¹é”èµ„æºçš„é‡Šæ”¾å¿…é¡»ç­‰åˆ°äº‹åŠ¡æœ€ç»ˆæäº¤çš„æ—¶å€™ã€‚è¿™æ ·æ¯”èµ·å•é˜¶æ®µæäº¤ï¼Œä¼šæ¶ˆè€—æ›´å¤šæ—¶é—´ã€‚äº‹åŠ¡æ‰§è¡Œæ—¶é—´å»¶é•¿ï¼Œæ„å‘³ç€é”èµ„æºå‘ç”Ÿå†²çªçš„æ¦‚ç‡å¢åŠ ã€‚</p>
<h3 id="saga">Saga</h3>
<p>å¤šä¸ªçŸ­æ—¶äº‹åŠ¡ç»„æˆçš„é•¿æ—¶äº‹åŠ¡ï¼Œåœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ª Saga åˆ†å¸ƒå¼äº‹åŠ¡çœ‹åšä¸€ä¸ªç”±å¤šä¸ªæœ¬åœ°äº‹åŠ¡ç»„æˆçš„äº‹åŠ¡ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„è¡¥å¿äº‹åŠ¡ã€‚åœ¨ Saga äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒæŸä¸€ä¸ªå‡ºé”™åï¼ŒSaga äº‹åŠ¡ä¼šç»ˆæ­¢ï¼ŒåŒæ—¶ä¼šè°ƒç”¨å¯¹åº”çš„è¡¥å¿äº‹åŠ¡å®Œæˆç›¸å…³çš„æ¢å¤æ“ä½œ<br>
è‡ªåŠ¨åå‘è¡¥å¿ã€‚Saga å®šä¹‰äº†ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ¯ä¸ªå­äº‹åŠ¡éƒ½å¯¹åº”ä¸€ä¸ªåå‘è¡¥å¿æ“ä½œã€‚Saga äº‹åŠ¡ç®¡ç†å™¨ä¼šæ ¹æ®æ‰§è¡Œç»“æœç”Ÿæˆä¸€å¼ æœ‰å‘æ— ç¯å›¾ï¼Œå¹¶åœ¨æ‰§è¡Œå›æ»šçš„æ—¶å€™æ ¹æ®è¯¥å›¾ä¸€æ¬¡æ‰§è¡Œåå‘è¡¥å¿æ“ä½œã€‚Saga äº‹åŠ¡ç®¡ç†å™¨åªç”¨äºä½•æ—¶é‡è¯•ï¼Œä½•æ—¶è¡¥å¿ï¼Œä¸è´Ÿè´£è¡¥å¿çš„å†…å®¹ï¼Œè¡¥å¿çš„å…·ä½“æ“ä½œç”±å¼€å‘è€…è‡ªè¡Œæä¾›ã€‚<br>
Sharding-JDBC é‡‡ç”¨äº†åå‘ sql æŠ€æœ¯ï¼Œå°†å¯¹æ•°æ®åº“çš„æ›´æ–°æ“ä½œçš„ sql è‡ªåŠ¨ç”Ÿæˆåå‘ sqlï¼Œå¹¶äº¤ç”± <a href="https://github.com/apache/servicecomb-saga-actuator">saga-actuator</a> æ‰§è¡Œã€‚</p>
<h3 id="seate">Seate</h3>
<p><a href="https://github.com/seata/seata">Seate</a><br>
<a href="https://shardingsphere.apache.org/document/current/cn/features/transaction/principle/base-transaction-seata/">Sharding-JDBC çš„å®ç°åŸç†</a>ã€‚æ•´åˆSeata ATäº‹åŠ¡æ—¶ï¼Œéœ€è¦æŠŠTMï¼ŒRMï¼ŒTCçš„æ¨¡å‹èå…¥åˆ°ShardingSphere åˆ†å¸ƒå¼äº‹åŠ¡çš„SPIçš„ç”Ÿæ€ä¸­ã€‚åœ¨æ•°æ®åº“èµ„æºä¸Šï¼ŒSeataé€šè¿‡å¯¹æ¥ DataSource æ¥å£ï¼Œè®©JDBCæ“ä½œå¯ä»¥åŒ TC è¿›è¡Œ RPC é€šä¿¡ã€‚åŒæ ·ï¼ŒShardingSphere ä¹Ÿæ˜¯é¢å‘ DataSource æ¥å£å¯¹ç”¨æˆ·é…ç½®çš„ç‰©ç† DataSource è¿›è¡Œäº†èšåˆï¼Œå› æ­¤æŠŠç‰©ç† DataSource äºŒæ¬¡åŒ…è£…ä¸º Seata çš„ DataSource åï¼Œå°±å¯ä»¥æŠŠ Seata AT äº‹åŠ¡èå…¥åˆ° ShardingSphere çš„åˆ†ç‰‡ä¸­ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring Batch è¿ç§»æ•°æ®]]></title>
        <id>https://jiangjinxinn.github.io/post/spring-batch-qian-yi-shu-ju</id>
        <link href="https://jiangjinxinn.github.io/post/spring-batch-qian-yi-shu-ju">
        </link>
        <updated>2019-10-03T17:26:51.000Z</updated>
        <content type="html"><![CDATA[<p>èƒŒæ™¯ï¼š<br>
åŸƒæ£®å“²å’Œ spring åˆä½œï¼Œä¸»è¦æ¥è‡ªåŸƒæ£®å“²çš„ç§¯ç´¯ï¼Œéšå JSR-352 è§„èŒƒ<br>
æ ¸å¿ƒåœ¨äºé¢†åŸŸæ¨¡å‹</p>
<p>ç›¸å…³èµ„æ–™:</p>
<ul>
<li><a href="https://cloud.tencent.com/developer/article/1456757">Spring Batch(1)â€”â€”æ•°æ®æ‰¹å¤„ç†æ¦‚å¿µ                                                                            - äº‘+ç¤¾åŒº - è…¾è®¯äº‘</a></li>
<li>https://docs.spring.io/spring-batch/4.2.x/reference/html/index.html</li>
<li>https://github.com/spring-projects/spring-batch/tree/master/spring-batch-samples</li>
<li>https://github.com/jxtaliu/SpringBatchSample</li>
</ul>
<p>é¢†åŸŸæ¨¡å‹:<br>
JobLanuncherã€jobã€jobInstance<br>
flow<br>
step<br>
tasklet (ç»†åŒ–å°ä»»åŠ¡ï¼‰<br>
chunk<br>
itemReader<br>
process<br>
itemWriter</p>
<p>ä¸€äº›é—®é¢˜:<br>
ä¸è¦æŠŠ jpa reader writer æ³¨å†Œä¸º beanï¼Œæ³¨é”€ bean çš„æ—¶å€™ä¼š close EntityManager ä¸¤éï¼ˆè¿™ä¸ªæ²¡æ·±ç©¶ï¼Œè§£å†³äº†é—®é¢˜æˆ‘å°±æºœäº†ï¼‰</p>
<p>ä»»åŠ¡ restart<br>
restart, é»˜è®¤å¤±è´¥çš„ä»»åŠ¡ä¸‹æ¬¡å¯åŠ¨ä¼šï¼Œé‡æ–°æ‰§è¡Œï¼Œæ ¹æ® JobRepository å­˜å‚¨çš„ä¿¡æ¯è¿›è¡Œ<br>
å¯ä»¥é€šè¿‡<code>org.springframework.batch.core.job.builder.JobBuilderHelper#preventRestart</code>  è¿›è¡Œå…³é—­<br>
ä¹Ÿå¯ä»¥åœ¨<code>org.springframework.batch.item.support.AbstractItemCountingItemStreamItemReader#setSaveState</code> å¯¹é½å…³é—­</p>
<p>ä»»åŠ¡ä¼šåœ¨ <code>BATCH_STEP_EXECUTION_CONTEXT</code>  è¡¨ä¸­æ·»åŠ è®°å½•æ‰§è¡Œè®°å½•ï¼Œå·² <code>JpaPagingItemReader</code> ä¸ºä¾‹ï¼Œä¼šè®°å½•å½“å‰å·²è¿›è¡Œåˆ°çš„æ•°ç›®count<br>
<code>{&quot;batch.taskletTypetaskletType&quot;:&quot;org.springframework.batch.core.step.item.ChunkOrientedTasklet&quot;,&quot;JpaPagingItemReader.read.count&quot;:428,&quot;batch.stepType&quot;:&quot;org.springframework.batch.core.step.tasklet.TaskletStep&quot;}</code><br>
å¦‚æœå¤±è´¥äº†ï¼Œä¸‹æ¬¡ä¼šä»è®°å½•çš„æ•°ç›®å¤„å¼€å§‹è¯»å–ï¼Œå¤±è´¥ skip æ‰çš„æ•°æ®ï¼Œä¹Ÿä¼šè¢«ç®—åˆ°è¯»å–çš„æ•°æ®ä¸Š</p>
<p>é‡è¯•ï¼Œè·³è¿‡<br>
step æ·»åŠ  backOffPolicy ç­‰å¾…ä¸€æ®µæ—¶é—´</p>
<p>step ä¹‹é—´å¤šçº¿ç¨‹<br>
å¤šä¸ª step å¹¶å‘<br>
è¿œç¨‹åˆ†ç‰‡ï¼Œåˆ†åŒº</p>
<pre><code>package name.ealen.batch;

import name.ealen.config.ExecutorConfiguration;
import name.ealen.listener.JobListener;
import name.ealen.model.Access;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.batch.core.ExitStatus;
import org.springframework.batch.core.Job;
import org.springframework.batch.core.Step;
import org.springframework.batch.core.configuration.annotation.EnableBatchProcessing;
import org.springframework.batch.core.configuration.annotation.JobBuilderFactory;
import org.springframework.batch.core.configuration.annotation.StepBuilderFactory;
import org.springframework.batch.core.launch.support.RunIdIncrementer;
import org.springframework.batch.item.ItemProcessor;
import org.springframework.batch.item.ItemReader;
import org.springframework.batch.item.ItemWriter;
import org.springframework.batch.item.database.JpaPagingItemReader;
import org.springframework.batch.item.database.orm.JpaNativeQueryProvider;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;

import javax.annotation.Resource;
import javax.persistence.EntityManagerFactory;

//**/
/ * Created by EalenXie on 2018/9/10 14:50./
/ * :@EnableBatchProcessingæä¾›ç”¨äºæ„å»ºæ‰¹å¤„ç†ä½œä¸šçš„åŸºæœ¬é…ç½®/
/ *//
@Configuration
@EnableBatchProcessing
public class DataBatchConfiguration {
    private static final Logger /log/= LoggerFactory./getLogger/(DataBatchConfiguration.class);

    @Resource
    private JobBuilderFactory jobBuilderFactory;    //ç”¨äºæ„å»ºJOB

    @Resource
    private StepBuilderFactory stepBuilderFactory;  //ç”¨äºæ„å»ºStep

    @Resource
    private EntityManagerFactory emf;           //æ³¨å…¥å®ä¾‹åŒ–Factory è®¿é—®æ•°æ®

    @Resource
    private JobListener jobListener;            //ç®€å•çš„JOB listener

    @Resource
    private ThreadPoolTaskExecutor threadPoolTaskExecutor;

    //**/
/     * ä¸€ä¸ªç®€å•åŸºç¡€çš„Jobé€šå¸¸ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªStepç»„æˆ/
/     *//
@Bean
    public Job dataHandleJob() {
        return jobBuilderFactory.get(&quot;dataHandleJob&quot;).
                incrementer(new RunIdIncrementer()).
                start(handleDataStep()).    //startæ˜¯JOBæ‰§è¡Œçš„ç¬¬ä¸€ä¸ªstep

//                next(xxxStep()).
//                next(xxxStep()).
//                ...
        listener(jobListener).      //è®¾ç½®äº†ä¸€ä¸ªç®€å•JobListener
                build();
    }

    //**/
/     * ä¸€ä¸ªç®€å•åŸºç¡€çš„Stepä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†/
/     * ItemReader : ç”¨äºè¯»å–æ•°æ®/
/     * ItemProcessor : ç”¨äºå¤„ç†æ•°æ®/
/     * ItemWriter : ç”¨äºå†™æ•°æ®/
/     *//
@Bean
    public Step handleDataStep() {
        return stepBuilderFactory.get(&quot;getData&quot;).
                &lt;Access, Access&gt;chunk(100).        // &lt;è¾“å…¥,è¾“å‡º&gt; ã€‚chunké€šä¿—çš„è®²ç±»ä¼¼äºSQLçš„commit; è¿™é‡Œè¡¨ç¤ºå¤„ç†(processor)100æ¡åå†™å…¥(writer)ä¸€æ¬¡ã€‚
                faultTolerant().retryLimit(3).retry(Exception.class).skipLimit(100).skip(Exception.class).
                listener(new SkipCheckingListener()). //æ•æ‰åˆ°å¼‚å¸¸å°±é‡è¯•,é‡è¯•100æ¬¡è¿˜æ˜¯å¼‚å¸¸,JOBå°±åœæ­¢å¹¶æ ‡å¿—å¤±è´¥
                reader(getDataReader()).         //æŒ‡å®šItemReader
                processor(getDataProcessor()).   //æŒ‡å®šItemProcessor
                writer(getDataWriter()).         //æŒ‡å®šItemWriter
                build();
    }

    public ItemReader&lt;? extends Access&gt; getDataReader() {
        //è¯»å–æ•°æ®,è¿™é‡Œå¯ä»¥ç”¨JPA,JDBC,JMS ç­‰æ–¹å¼ è¯»å…¥æ•°æ®
        JpaPagingItemReader&lt;Access&gt; reader = new JpaPagingItemReader&lt;&gt;();
        //è¿™é‡Œé€‰æ‹©JPAæ–¹å¼è¯»æ•°æ® ä¸€ä¸ªç®€å•çš„ native SQL
        String sqlQuery = â€œSELECT * FROM accessâ€;
        try {
            JpaNativeQueryProvider&lt;Access&gt; queryProvider = new JpaNativeQueryProvider&lt;&gt;();
            queryProvider.setSqlQuery(sqlQuery);
            queryProvider.setEntityClass(Access.class);
            queryProvider.afterPropertiesSet();
            reader.setEntityManagerFactory(emf);
            reader.setPageSize(3);
            reader.setQueryProvider(queryProvider);
            reader.afterPropertiesSet();
            //æ‰€æœ‰ItemReaderå’ŒItemWriterå®ç°éƒ½ä¼šåœ¨ExecutionContextæäº¤ä¹‹å‰å°†å…¶å½“å‰çŠ¶æ€å­˜å‚¨åœ¨å…¶ä¸­,å¦‚æœä¸å¸Œæœ›è¿™æ ·åš,å¯ä»¥è®¾ç½®setSaveState(false)
            reader.setSaveState(true);
        } catch (Exception e) {
            e.printStackTrace();
        }
        return reader;
    }

    public ItemProcessor&lt;Access, Access&gt; getDataProcessor() {
        return new ItemProcessor&lt;Access, Access&gt;() {
            @Override
            public Access process(Access access) throws Exception {
                /log/.info(â€œprocessor data : â€œ + access.toString());  //æ¨¡æ‹Ÿ  å‡è£…å¤„ç†æ•°æ®,è¿™é‡Œå¤„ç†å°±æ˜¯æ‰“å°ä¸€ä¸‹
                return access;
            }
        };
//        lambdaä¹Ÿå¯ä»¥å†™ä¸º:
//        return access -&gt; {
//            log.info(â€œprocessor data : â€œ + access.toString());
//            return access;
//        };
    }

    public ItemWriter&lt;Access&gt; getDataWriter() {
        return list -&gt; {
            for (Access access : list) {
                /log/.info(â€œwrite data : â€œ + access); //æ¨¡æ‹Ÿ å‡è£…å†™æ•°æ® ,è¿™é‡Œå†™çœŸæ­£å†™å…¥æ•°æ®çš„é€»è¾‘
            }
        };
    }


}

</code></pre>
<p>æ —å­ï¼š<br>
è®¾ç½®ä¸¤ä¸ªæ•°æ®æºï¼Œé€šè¿‡ spring batch è¿›è¡Œè·¨æ•°æ®åº“æ•°æ®è¿ç§»ï¼Œé€šè¿‡ JpaPagingItemReader è¿›è¡Œè¯»å–æ•°æ®ï¼Œç”¨ jdbcTemplate è¿›è¡Œæ•°æ®å†™å…¥ï¼Œ<br>
å†å®ç° <code>org.springframework.batch.core.SkipListener</code> æ¥å£è®°å½•è·³è¿‡çš„æ•°æ®ï¼Œç¨åäººå·¥å¤„ç†ï¼Œè¿›è¡Œæ¯”å¯¹å¤„ç†</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://jiangjinxinn.github.io/post/hello-gridea</id>
        <link href="https://jiangjinxinn.github.io/post/hello-gridea">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="http://hvenotes.fehey.com/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>ğ–¶ğ—‚ğ—‡ğ–½ğ—ˆğ—ğ—Œ</strong> æˆ– <strong>ğ–¬ğ–ºğ–¼ğ–®ğ–²</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>